Download the 2015 race table
--use import wizard to bring it into Excel. Make sure leading zero is preserved in 2nd column
--Delete margin of error columns

Download the 2015 ethnicity table
--use import wizard to bring it into Excel. Make sure leading zero is preserved in 2nd column
--Delete margin of error columns

Use VLOOKUP to merge the two files (joining on the first column); bring the ethnicity data into the race table
--you'll need to repeat vlookup for each column (hispanic total and non-hispanic total)

Save this as a new Excel file

Create the diversity index
--Create a new total population field (excluding the "other race" category
--generate new columns with percentage of total for each racial group (white, black, asian,etc) except the other race and 2 or more races
--generate new columns where you will square the percentage (that you just created). To square -- celladdress^2
--add the squared percentages together in a new column (this will be your total)
--repeat all these steps for ethnicity, except for this one use the total population (Hispanic plus non-Hispanic) for the denominator in your percentage calculations.

When you have totals for both race and ethnicity, then you'll do a formula that multiples the two totals, subtract that from 1, and then multiply the result by 100.
You can do it all in one formula like this (you'll need to change x2 and y2 to the correct cell address

=(1-(x2*y2))*100




Import the 1990 race & ethnicity table into Excel (be sure to preserve leading zeros in "statea" and "countya" fields
--create a join column by combining the state fips code ("statea") and the county fips code ("countya")

--Create a diversity index here (like in the directions above, except there won't be a "2 or more races" column to worry about)



Final step:
We'll create a new sheet that pulls the 1990 diversity index to match with the 2015 county names and 2015 diversity index 
(It's possible that there are counties that didn't exist in 1990 or had different name or something,
so it's important to use the 2015 data as our base)
The new sheet will have the ID numbers from the 2015 data, the state and county names, the 2015 diversity index and the 1990 diversity index

--Then calculate the difference between the 1990 and 2015 indexes (subtract  new-old)


Save this new sheet in Excel


Then do a save as to save the new sheet as a .csv file for QGIS

Create a CSVT file
"String", "String", "Integer"  (this isn't exact-- it will need to match whatever fields we have in the sheet)

save it as a text file with .csvt extension


Download Census TIGER shapefile for 2015 county boundaries (whole US)
https://www.census.gov/geo/maps-data/data/tiger-line.html


