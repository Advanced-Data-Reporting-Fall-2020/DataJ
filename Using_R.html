<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Data journalism training: Getting started with R</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>Data Journalism:<br> Getting started with R</h1>
		  <h2><a href="https://twitter.com/MaryJoWebster">By MaryJo Webster</a></h2>
        </header>
        <hr>

        <section id="main_content">
		<p>I'm just getting started learning R, so I'm going to start collecting useful stuff here. It will be a work in progress. I welcome any suggestions you have to either add to this site or offer up better approaches than what I'm offering here.</p>
		<p>To get started you need to <a href="https://www.r-project.org/">download R.</a> And then I <strong>highly</strong> recommend using <a href="https://www.rstudio.com/products/rstudio/download/">RStudio</a> as an interface, so you'll need to download that, as well.</li>
		
		
		<h2>Useful beginner training materials</h2>
		<ul>
		<li><a href="https://www.edx.org/course/introduction-r-data-science-microsoft-dat204x-6">Microsoft edX- Introduction to R for Data Science</a> I found this free course useful for the very basics of R, especially in getting a handle on terminology and syntax.</li>
		<li><a href="https://paldhous.github.io/wcsj/2017/">Peter Aldous' Data Analysis with R training materials</a>. This site really opened the door for me. It focuses on the SQL-like capabilities of the dplyr package and using ggplot2 for visualizations and uses real journalism examples.</li>
		<li><a href="https://github.com/dhmontgomery/r-data-for-beginners/blob/master/r_for_beginners.md">David Montgomery's R for Beginners</a>. This was a good second tutorial to hit. Also focuses on the SQL-like capaibilities and visualizations with real journalism example, but goes a little deeper than Aldous' tutorial.</li>
		<li><a href="https://www.computerworld.com/article/2497143/business-intelligence/business-intelligence-beginner-s-guide-to-r-introduction.html">Beginner's guide to R, by Sharon Machlis</a>. This covers a lot of basic ground and provides a ton of useful links</li>
		<li><a href="http://r4ds.had.co.nz/">E-book: R for Data Science by Garrett Grolemund and Hadley Wickham.</a></li>
		<li><a href="https://www.jessesadler.com/post/excel-vs-r/">Excel vs R: A Brief Introduction to R</a></li>
		
		</ul>
		<h2>Useful R packages & how-to's</h2>
		<p>Most of the great capabilities that you can unleash with R come via packages (like libraries) that you need to install separately. There are thousands of packages! Here are ones I've found to be must-have's.</p>
		<ul>
		<li><a href="https://www.tidyverse.org/packages/">Tidyverse- a collection of packages</a>. This gives you the SQL-like capabilities and tools for making visualizations.</li>
		<li><a href="http://www.ggplot2-exts.org/gallery/">ggplot2 gallery of extensions</a>. ggplot2 comes with tidyverse, but here you can find links to a ton of extensions, including gganimate for animating your graphics.</li>
		<li><a href="http://www.datacarpentry.org/dc_zurich/R-ecology/04-dplyr.html">Aggregating and analyzing data with dplyr</a>. Useful guide to using dplyr package (which comes with tidyverse)</li>
		<li><a href="http://rprogramming.net/recode-data-in-r/">How to recode data in R</a></li>
		<li><a href="https://d4tagirl.com/2017/05/how-to-plot-animated-maps-with-gganimate">How to plot animated maps with gganimate</a> This code can be applied to other graphic types, as well.</li>
		<li><a href="http://www.r-graph-gallery.com/">The R Graph Gallery</a> Includes examples of code for how to make a variety of graphics with ggplot2</li>
		<li><a href="http://www.cookbook-r.com/">Cookbook for R</a></li>
		<li>This new package looks promising: <a href="https://cran.r-project.org/web/packages/census/index.html"> census package</a> to scrape US Census data. I haven't tried it out yet, though. </li>
		<li>This new package looks fun: <a href="https://cran.r-project.org/web/packages/billboard/index.html"> billboard package</a> including scraped datasets related to the Billlboard Top 100 going back to 1960. Would be a fun dataset to use for training. </li>
		<li><a href="http://lubridate.tidyverse.org/">Lubridate package</a> for working with dates.</li>
		</ul>
		<h2>Working with IPUMS data in R</h2>
		<p>The <a href="https://pop.umn.edu/">Minnesota Population Center</a> recently released <a href="https://cran.r-project.org/web/packages/ipumsr/index.html">an R package called IPUMSR</a> for pulling in various IPUMS datasets, including CPS, NHGIS and IPUMS-USA. The documentation is very clear. It's important to spend some time reading about how value labels work <a href="https://cran.r-project.org/web/packages/ipumsr/vignettes/value-labels.html"> in this vignette.</a></p>
		<h2>R Studio</h2>
		<p>R Studio gives you several options for working with R. I'm particularly liking using <a href="https://blog.rstudio.com/2016/10/05/r-notebooks/">R Notebook</a>. It allows you to have your code and the results all inline with each other. It also spits out an html file with all of that. Since most of my work involves pairing up with other reporters and editors, I can see how I'll be able to share the html file with them so they can see the various tables and charts I've produced along the way. The html file allows the user to "hide all code," leaving behind just the tables and charts. Here's <a href="https://mjwebster.github.io/Rprojects/jobs_notebook.nb.html">a notebook</a> I made using Bureau of Labor Statistics data.</p>
		<h2>dplyr</h2>
		<p>My favorite package so far is dplyr, which comes with Tidyverse. It works so much like SQL -- which I've known for a long time -- so it's been very easy to pick up. Interestingly, it seems like dplyr is more flexible and lightweight than SQL. It's possible to run a query that filters and summarizes and arranges your data, then add a new column calculating a rank or a percentage all with just five or six lines of simple code. Doing that in SQL is mind-numbing. I picked up most of dplyr through some of the tutorials linked above, but I also laid out some cash for this <a href="https://www.datacamp.com/courses/dplyr-data-manipulation-r-tutorial">DataCamp class</a>, which I found to be really helpful.</p>
		<h2>Pull data from a server</h2>
		<p>Since I store the bulk of my data on a mySQL server (on Amazon), it's really great to be able to connect R to the server. There are a few ways to do this, however it seems the route most people use is the <a href="https://cran.r-project.org/web/packages/RMySQL/index.html">RMySQL package.</a>  This one caused me a few headaches because I had a hard time figuring out a good way to connect without storing my username and password in the code. Supposedly you can use a "my.cnf" file, but I couldn't get that to work -- even after extensive googling on the problem. Ultimately, I settled on using an RStudio option to have it prompt you for the username and password and the host connection.</p>
		<p>Here's what that code looks like. Note, I'm not displaying dbname here (name of the database within the server):</p>
		<p>
		install.packages("RMySQL")<br>
		library(RMySQL)<br>
		myconnection <- dbConnect(RMySQL ::MySQL(),<br>
			host=rstudioapi:askForPassword("host"),<br>
			dbname="******",<br>
			user=rstudioapi:askForPassword("Database user"),<br>
			password=rstudioapi::askForPassword("Database password"))<br>
			</p>
		<p>Then you can have it load a list of the tables on the server using:<br>  dbListTables(myconnection)</p>
		<p>Or have it list the fields for a particular table on the server:<br>  dbListFields(myconnection, 'tablename')</p>
		<p>You can run a query on the server like this:<br> mydata <- dbSendQuery(myconnection, "select * from tablename where gender='F'")</p>
		<p>Then you can turn that into a dataframe, if you want:<br>  mydf <- fetch(mydata, n=-1)</p>
		<p>The "-1" in that last piece of code tells it to return all the records. You could change that if you, for example, only want the first 100 records or something like that</p>
		<p>Once you have the data in a data frame, then you can use dplyr or whatever other code to analyze your data frame.</p>
		<h2>Appending files together</h2>
		<p>A common problem in data journalism is that the government agency gives you a separate data file for each year of data you requested. Or you get a data file one year. Then the next year you get an updated batch that you need to append to the first. As long as each file contains all the same columns (and column labels), there are a couple different ways (at least!) to append multiple files together.</p>
		<p>If you want to append together all the csv files from within a given directory, Andrew Ba Tran has made this lovely package called <a href="https://andrewbtran.github.io/muckrakr/bulk_csv.html">"bulk_csv"</a>. He also has one for putting together Excel files. All of his packages <a href="https://github.com/andrewbtran/muckrakr"> are here</a></p>
		<p>If you're just putting together a couple files, you can use R's rbind function. First you need to load the csv's into data frames, then you create a data frame (which I've named "merged" below) to put them together.</p>
		<p>table1 <- read_csv("table1.csv")<br>
		table2<- read_csv("table2.csv")<br>
		merged <- rbind(table1, table2)<br></p>
		<p>Interesting side note.....It's also possible to tell it to filter the records from each of the csv's and only merge together certain rows. Here's <a href="https://mjwebster.github.io/Rprojects/jobs_notebook.nb.html">the code</a> I used to do that on some Bureau of Labor Statistics data, pulling out only records for food establishments. (I used rbind for this since it was before I discovered bulk_csv)</p>
		<h2>Joining data frames</h2>
		<p>Another common issue for us data journalists is having to join two datasets together on one or more common fields/columns. Just like SQL, you can do an inner_join (return only matching records) or left_join (return all records from the first table listed and only those that match from the second table) using the dplyr package. Here's the <a href="https://www.rdocumentation.org/packages/dplyr/versions/0.7.3/topics/join"> official documentation on joining.</a> In the code below you can replace the two instances of "fieldname" with the correct names of columns in your two tables that match. And replace "table1" and "table2" with the names of the two data frames you are joining. In my example, "newtable" is the name of the new data frame I'm creating from this join.</p>
		<p>newtable <- inner_join(table1, table2, by=c("fieldname"="fieldname"))</p>
		


	

		
		
		
		
		
		
		</section>

        <footer>
          DataJTraining is maintained by <a href="https://github.com/mjwebster">mjwebster</a><br>
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

        
      </div>
    </div>
  </body>
</html>